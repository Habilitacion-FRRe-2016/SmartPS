<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <h:head>
    	<title>SmartPS</title>
    </h:head>
    
    <h:body >

 	<ui:composition template="/templates/template.xhtml">
 		<ui:define name="content"> 

 			<h:form id="form">
				<h3><p:outputLabel value="Buscar PS"/></h3>
				<p:separator/>
				<br></br>
				<p:growl id="msgs" showDetail="true"/>
				<p:dataTable id="pss" value="#{consultarPS.pss}" var="ps" selectionMode="single" selection="#{consultarPS.ps}" rowKey="#{ps.id}" widgetVar="pssTable">
				    <f:facet name="header">
				 			<h3><p:outputLabel value=""/></h3>
				    </f:facet>
									    				
					<p:column headerText="Título" filterBy="#{ps.titulo}" filterMatchMode="contains">
						#{ps.titulo}
					</p:column>
					
					<p:column headerText="Nombre Alumno" filterBy="#{ps.alumno.nombre}" filterMatchMode="contains">
						#{ps.alumno.nombre}
					</p:column>
					
					<p:column headerText="Legajo" filterBy="#{ps.alumno.legajo}">
						#{ps.alumno.legajo}
					</p:column>
					
					<p:column headerText="Estado" filterBy="#{ps.estado.nombre}" filterMatchMode="contains">
						#{ps.estado.nombre}
					</p:column>
					
					<p:column headerText="Area" filterBy="#{ps.area.nombre}" filterMatchMode="contains">
						#{ps.area.nombre}
					</p:column>
					
					<p:column headerText="Organizacion" filterBy="#{ps.organizacion.nombre}" filterMatchMode="contains">
	
						#{ps.organizacion.nombre}
					</p:column>
					
					<p:column headerText="Tipo Actividad" filterBy="#{ps.tipoActividad.nombre}" filterMatchMode="contains">
						#{ps.tipoActividad.nombre}
					</p:column>
					
					
					
					<p:column headerText="Ciclo lectivo" filterBy="#{ps.cicloLectivo}">
						#{ps.cicloLectivo}
					</p:column>
					
					<p:column filterBy="#{ps.cuatrimestre}"  headerText="Cuatrimestre">
	<!-- 					<f:facet name="filter"> -->
	<!-- 		                <p:selectCheckboxMenu label="Cuantrimestre" onchange="PF('pssTable').filter()" panelStyle="width:125px" scrollHeight="150"> -->
	<!-- 		                    <f:selectItem itemLabel="1" itemValue="1" /> -->
	<!-- 		                    <f:selectItem itemLabel="2" itemValue="2" /> -->
	<!-- 		                </p:selectCheckboxMenu> -->
	<!-- 		            </f:facet> -->
						
						#{ps.cuatrimestre}
					</p:column>
					
			        <f:facet name="footer">
			            <p:commandButton id="btnBuscarPlanes" update="@(.ui-datatable)" icon="ui-icon-search" value="Ver planes" oncomplete="PF('dialogoPlanes').show()" actionListener="#{consultarPS.actualizarPlanes()}" />
			            <p:commandButton id="btnBuscarInformes" update="@(.ui-datatable)" icon="ui-icon-search" value="Ver informes" oncomplete="PF('dialogoInformes').show()" actionListener="#{consultarPS.actualizarInformes()}" />
			            <p:commandButton id="btnModificarPS" update="@(.ui-panel)" icon="ui-icon-pencil" value="Modificar PS"  oncomplete="PF('dialogoModifPS').show()"  actionListener="#{consultarPS.actualizarPS()}" />
			        </f:facet>				
					  
				</p:dataTable>
				
				<p:dialog widgetVar="dialogoPlanes">
					<p:outputPanel id="planes" >
						<p:dataTable value="#{consultarPS.planes}" var="plan" style="width:600px" editable="true">
							<p:ajax event="rowEdit" listener="#{consultarPS.editarColumnaPlan}" update="@(.ui-growl)" />
							<p:ajax event="rowEditCancel" listener="#{consultarPS.cancelarEdicionColumna}" update="@(.ui-growl)" />	
							
							<p:column headerText="Fecha de presentación">
	       						

								<p:cellEditor>
	       							<f:facet name="output">
			       						<p:outputLabel value="#{plan.fechaDePresentacion}">
			       							<f:convertDateTime type="date" locale="es_AR"/>
			       						</p:outputLabel>	       							
	       							</f:facet>
	       							<f:facet name="input">
	       								<p:calendar value="#{plan.fechaDePresentacion}"/>	
	       							</f:facet>
	       						
	       						</p:cellEditor>
							</p:column>
							
							<p:column headerText="Fecha de evaluación">
								<p:cellEditor>
									<f:facet name="output">
										<p:outputLabel value="#{plan.fechaAprobDesaprob}">
											<f:convertDateTime type="date" locale="es_AR"/>
										</p:outputLabel>									
									</f:facet>
									<f:facet name="input">
										<p:calendar value="#{plan.fechaAprobDesaprob}"/>
									</f:facet>
								</p:cellEditor>
							</p:column>
							
							<p:column headerText="Observación">
								<p:cellEditor>
									<f:facet name="output"><h:outputText value="#{plan.observaciones}" /></f:facet>
	               					<f:facet name="input"><p:inputText id="modelInput" value="#{plan.observaciones}" style="width:100%"/></f:facet>
								</p:cellEditor>
							</p:column>
							<p:column>
							    <p:rowEditor/>
							</p:column>
							
							
						</p:dataTable>
					</p:outputPanel>						
				</p:dialog>
				
				<p:dialog widgetVar="dialogoInformes">
					<p:outputPanel id="informes" >
						<p:dataTable value="#{consultarPS.informes}" var="informe" style="width:600px" editable="true">
							<p:ajax event="rowEdit" listener="#{consultarPS.editarColumnaInforme}" update="@(.ui-growl)" />
							<p:ajax event="rowEditCancel" listener="#{consultarPS.cancelarEdicionColumna}" update="@(.ui-growl)" />
									
							<p:column headerText="Fecha de presentación">
	       						<p:cellEditor>
	       							<f:facet name="output">
	       								<p:outputLabel value="#{informes.fechaDePresentacion}">
			       							<f:convertDateTime type="date" locale="es_AR"/>
			       						</p:outputLabel>	
	       							</f:facet>
	       							
	       							<f:facet name="input">
	       								<p:calendar value="#{informes.fechaDePresentacion}" />
	       							</f:facet>
	       						</p:cellEditor>
							</p:column>
							
							<p:column headerText="Fecha de evaluación">
								<p:cellEditor>
									<f:facet name="output">
										<p:outputLabel value="#{informe.fechaAprobDesaprob}">
											<f:convertDateTime type="date" locale="es_AR"/>
										</p:outputLabel>									
									</f:facet>
									
									<f:facet name="input">
										<p:calendar value="#{informe.fechaAprobDesaprob}"/>
									</f:facet>
							
								</p:cellEditor>
							</p:column>
							
							
							<p:column headerText="Observación">
								<p:cellEditor>
									<f:facet name="output"><h:outputText value="#{informe.observaciones}" /></f:facet>
	               					<f:facet name="input"><p:inputText id="modelInput" value="#{informe.observaciones}" style="width:100%"/></f:facet>
								</p:cellEditor>
							</p:column>
							<p:column>
							    <p:rowEditor/>
							</p:column>
							
							
						</p:dataTable>
					</p:outputPanel>						
				</p:dialog>
				
				<p:dialog widgetVar="dialogoModifPS">
					
						<p:panel id="panelEdicionPS" autoUpdate="true" >
							<p:panelGrid columns="2">
								<p:outputLabel value="Titulo"/>
								<p:inputText value="#{consultarPS.modifPS.titulo}" />
								<p:outputLabel value="Ciclo lectivo"/>
								<p:inputText value="#{consultarPS.modifPS.cicloLectivo}" />								
								<p:outputLabel value="Cuatrimestre"/>
								<p:inputText value="#{consultarPS.modifPS.cuatrimestre}" />
				        		
				        		<p:outputLabel value="Tipo" />			        		
				        		<p:selectOneMenu value="#{consultarPS.actSelec}"  >
				        			<p:ajax listener="#{consultarPS.cambioAct}" />
				        			<f:selectItems value="#{tipoActBean.tiposAct}" var="act" itemLabel="#{act.nombre}" itemValue="#{act.id}" itemDescription="#{act.descripsion}"/>
				        		</p:selectOneMenu>
				        		
				        		<p:outputLabel value="Area" />
								<p:selectOneMenu value="#{consultarPS.areaSelec}">
									<p:ajax listener="#{consultarPS.cambioArea}" />
									<f:selectItem itemLabel="Seleccione uno" itemValue="" />
									<f:selectItems value="#{areaBean.areas}" var="area" itemLabel="#{area.nombre}" itemValue="#{area.id}" itemDescription="#{area.descripsion}" />							
								</p:selectOneMenu>
								
			        			<p:outputLabel value="Organización:" />
			        			<p:selectOneMenu value="#{consultarPS.orgSelec}" filter="true">
				        			<p:ajax listener="#{consultarPS.cambioOrg}" />
				        			<f:selectItem itemLabel="Seleccione uno" itemValue="" noSelectionOption="true" />
				        			<f:selectItems value="#{orgBean.organizaciones}" var="org" itemLabel="#{org.nombre}" itemValue="#{org.id}"  itemDescription="#{org.descripsion}"/>
			        			</p:selectOneMenu>								

								
								<p:commandButton value="Guardar cambios" update="@(.ui-datatable)" actionListener="#{consultarPS.guardarCambiosPS()}" oncomplete="PF('dialogoModifPS').hide()" />								
							</p:panelGrid>
						</p:panel>

				</p:dialog>


 			</h:form> 			 			

 		</ui:define>
 		 
 	</ui:composition>

    </h:body>
</html>